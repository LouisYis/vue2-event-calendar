/*!
  * vue2-event-calendar.js v0.2.4
  * (c) 2018 Kitwang Chen
  * Released under the MIT License.
  */
"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var moment=_interopDefault(require("moment")),dateFunc={methods:{getMonthViewStartDay:function(t,e,a){e=parseInt(e);var n=this.moment(t),i=this.moment(n.startOf(a));return n.subtract(i.day(),"days"),i.day()<e&&n.subtract(7,"days"),n.add(e,"days"),n},getMonthViewEndDay:function(t){return this.getMonthViewStartDay().add(6,"weeks")}}},genBody={methods:{genWeekTitle:function(e){var a=this.prefixCls+"-week-title",n=this.weekDateShort||this.localeData[this.locale],i=this.firstDay-1,t=n.map(function(t){return 7<=++i&&(i=0),e("div",{class:[a+"-item"]},[n[i]])});return e("div",{class:[a]},[t])},genCalendateItem:function(n){var i=this,r=this.genItemRow(n),s=[];return this.monthData.map(function(t,e){var a=n("div",{class:i.prefixCls+"-day-item"},[i.$scopedSlots.default?i.$scopedSlots.default(t):i.$slots.default]);r.children.push(a),0<e-1&&(e+1)%7==0&&(s.push(r),r=i.genItemRow(n))}),n("div",{class:[this.prefixCls+"-body"]},[s])},genItemRow:function(t){return t("div",{class:[this.prefixCls+"-body-row"]},[])}}},genHeader={computed:{headerDateText:function(){return"week"===this.mode?this.moment(this.formatedDay).startOf("week").format("YYYY-MM-DD")+" - "+this.moment(this.formatedDay).endOf("week").format("YYYY-MM-DD"):this.moment(this.formatedDay).format("YYYY-MM")}},methods:{genHeaderCenter:function(t){var e=t("a",{class:[this.prefixCls+"-control",this.prefixCls+"-prev"],on:{click:this.prev}},[this.prevNode||"<"]),a=t("a",{class:[this.prefixCls+"-control",this.prefixCls+"-next"],on:{click:this.next}},[this.nextNode||">"]),n=t("span",{class:[this.prefixCls+"-header-date"]},[this.headerDateText]);return t("div",{class:[this.prefixCls+"-header-center"]},[e,n,a])},genHeader:function(t){var e=t("div",{class:[this.prefixCls+"-header-left"]},[this.$slots["header-left"]]),a=t("div",{class:[this.prefixCls+"-header-right"]},[this.$slots["header-right"]]);return t("div",{class:[this.prefixCls+"-header"]},[e,this.genHeaderCenter(t),a])}}},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},prefixCls="vue-calendar",calendar$1={name:prefixCls,mixins:[genBody,genHeader,dateFunc],props:{startDate:[Number,String,Date],dateData:{type:Array,default:function(){return[]}},matchKey:{type:String,default:"date"},locale:{type:String,default:"zh-cn"},firstDay:{type:Number,default:0},mode:{type:String,default:"month",validator:function(t){return"month"===t||"week"===t}},prefixCls:{type:String,default:prefixCls},weekDateShort:Array,onMonthChange:Function,onPrev:Function,onNext:Function},computed:{formatedDay:function(){return this.moment(this.currentDay)},monthData:function(){var e=this,t=this.dateData,a=this.formatedDay,n=this.firstDay,i=this.mode;if(!a)return[];var r=this.getMonthViewStartDay(a,n,i),s=[],o=6;"week"===this.mode&&(o=1);for(var h=0;h<7*o;h++){var d=t.find(function(t){return r.isSame(e.moment(new Date(t[e.matchKey])),"day")});s.push(_extends({},this.getItemStatus(r),{data:d||{},date:{year:r.year(),month:r.month()+1,date:r.date(),day:r.day(),full:r.format("YYYY-MM-DD")}})),r.add(1,"day")}return s}},methods:{changeDate:function(t){if("string"!=typeof t&&"[object Date]"!==Object.prototype.toString.call(t))return console.error("invalied date!"),!1;this.currentDay=t},prev:function(){this.currentDay=this.formatedDay.subtract(1,this.mode+"s").startOf(this.mode).format("YYYY-MM-DD"),this.onPrev&&this.onPrev({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})},next:function(){this.currentDay=this.formatedDay.add(1,this.mode+"s").startOf(this.mode).format("YYYY-MM-DD"),this.onNext&&this.onNext({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})},getItemStatus:function(t){var e=t.isSame(this.formatedDay,"month"),a=!1,n=!1,i=!e&&t.isBefore(this.formatedDay,"month"),r=!e&&t.isAfter(this.formatedDay,"month");return i&&(a=t.isSame(this.moment(t).endOf("month").format("YYYY-MM-DD"))),r&&(n=t.isSame(this.moment(t).startOf("month").format("YYYY-MM-DD"))),{isPrevMonth:i,isPrevLastDay:a,isNextMonth:r,isNextFirstDay:n,isToday:t.isSame(this.moment(this.today),"day"),isCurMonth:e}},changeViewData:function(){this.onMonthChange&&this.onMonthChange({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})}},watch:{startDate:{immediate:!0,handler:function(t){this.currentDay=t?new Date(t):new Date,this.today||(this.today=t)}},currentDay:{immediate:!0,handler:function(t,e){this.changeViewData()}},mode:function(t){this.changeViewData()}},data:function(){return{today:"",currentDay:null,moment:moment,localeData:{"zh-cn":"周日_周一_周二_周三_周四_周五_周六".split("_"),en:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_")}}},render:function(t){return t("div",{class:[this.prefixCls]},[this.genHeader(t),this.genWeekTitle(t),this.genCalendateItem(t)])}};module.exports=calendar$1;