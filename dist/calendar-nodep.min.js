/*!
  * vue2-event-calendar.js v0.2.9
  * (c) 2018 Kitwang Chen
  * Released under the MIT License.
  */
"use strict";function _interopDefault(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var moment=_interopDefault(require("moment"));function getMonthViewStartDay(t,e,a){e=parseInt(e);var n=moment(t),r=moment(n.startOf(a));return n.subtract(r.day(),"days"),r.day()<e&&n.subtract(7,"days"),n.add(e,"days"),n}var genBody={methods:{genWeekTitle:function(e){var a=this.prefixCls+"-week-title",n=this.weekDateShort||this.localeData[this.locale],r=this.firstDay-1,t=n.map(function(t){return 7<=++r&&(r=0),e("div",{class:[a+"-item"]},[n[r]])});return e("div",{class:[a]},[t])},genCalendateItem:function(n){var r=this,i=this.genItemRow(n),s=[];return this.monthData.map(function(t,e){var a=n("div",{class:r.prefixCls+"-day-item"},[r.$scopedSlots.default?r.$scopedSlots.default(t):r.$slots.default]);i.children.push(a),0<e-1&&(e+1)%7==0&&(s.push(i),i=r.genItemRow(n))}),n("div",{class:[this.prefixCls+"-body"]},[s])},genItemRow:function(t){return t("div",{class:[this.prefixCls+"-body-row"]},[])}}},genHeader={computed:{headerDateText:function(){return"week"===this.mode?moment(this.formatedDay).startOf("week").format("YYYY-MM-DD")+" - "+moment(this.formatedDay).endOf("week").format("YYYY-MM-DD"):moment(this.formatedDay).format("YYYY-MM")}},methods:{genHeaderCenter:function(t){var e=t("a",{class:[this.prefixCls+"-control",this.prefixCls+"-prev"],on:{click:this.prev}},[this.prevNode||"<"]),a=t("a",{class:[this.prefixCls+"-control",this.prefixCls+"-next"],on:{click:this.next}},[this.nextNode||">"]),n=t("span",{class:[this.prefixCls+"-header-date"]},[this.headerDateText]);return t("div",{class:[this.prefixCls+"-header-center"]},[e,n,a])},genHeader:function(t){var e=t("div",{class:[this.prefixCls+"-header-left"]},[this.$slots["header-left"]]),a=t("div",{class:[this.prefixCls+"-header-right"]},[this.$slots["header-right"]]);return t("div",{class:[this.prefixCls+"-header"]},[e,this.genHeaderCenter(t),a])}}},_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(t[n]=a[n])}return t},prefixCls="vue-calendar";function checkType(t){return Object.prototype.toString.call(t)}var calendar$1={name:prefixCls,mixins:[genBody,genHeader],props:{startDate:[Number,String,Date],dateData:[Object,Array],matchKey:{type:String,default:"date"},locale:{type:String,default:"en"},firstDay:{type:Number,default:0},mode:{type:String,default:"month",validator:function(t){return"month"===t||"week"===t}},prefixCls:{type:String,default:prefixCls},weekDateShort:Array,onMonthChange:Function,onPrev:Function,onNext:Function},computed:{formatedDay:function(){return moment(this.currentDay)},monthData:function(){var a=this,n=this.dateData,t=this.formatedDay,e=this.firstDay,r=this.mode,i=checkType(n);if(!t)return[];var s=getMonthViewStartDay(t,e,r),o=[],h=6;"week"===this.mode&&(h=1);for(var d=function(t){var e=[];"[object Object]"===i?Object.keys(n).forEach(function(t){s.isSame(moment(new Date(t)),"day")&&e.push(n[t])}):"[object Array]"===i&&(e=n.filter(function(t){return s.isSame(moment(new Date(t[a.matchKey])),"day")})),o.push(_extends({},a.getItemStatus(s),{data:e||{},date:{year:s.year(),month:s.month()+1,date:s.date(),day:s.day(),full:s.format("YYYY-MM-DD")}})),s.add(1,"day")},m=0;m<7*h;m++)d();return o}},methods:{changeDate:function(t){if("string"!=typeof t&&"[object Date]"!==Object.prototype.toString.call(t))return console.error("invalied date!"),!1;this.currentDay=t},prev:function(){this.currentDay=this.formatedDay.subtract(1,this.mode+"s").startOf(this.mode).format("YYYY-MM-DD"),this.onPrev&&this.onPrev({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})},next:function(){this.currentDay=this.formatedDay.add(1,this.mode+"s").startOf(this.mode).format("YYYY-MM-DD"),this.onNext&&this.onNext({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})},getItemStatus:function(t){var e=t.isSame(this.formatedDay,"month"),a=!1,n=!1,r=!e&&t.isBefore(this.formatedDay,"month"),i=!e&&t.isAfter(this.formatedDay,"month");return r&&(a=t.isSame(moment(t).endOf("month").format("YYYY-MM-DD"))),i&&(n=t.isSame(moment(t).startOf("month").format("YYYY-MM-DD"))),{isPrevMonth:r,isPrevLastDay:a,isNextMonth:i,isNextFirstDay:n,isToday:t.isSame(moment(this.today),"day"),isCurMonth:e}},changeViewData:function(){this.onMonthChange&&this.onMonthChange({startDay:this.monthData[0].date,endDay:this.monthData[this.monthData.length-1].date})}},watch:{startDate:{immediate:!0,handler:function(t){this.currentDay=t?new Date(t):new Date,this.today||(this.today=t)}},currentDay:{immediate:!0,handler:function(t,e){this.changeViewData()}},mode:function(t){this.changeViewData()}},data:function(){return{today:"",currentDay:null,localeData:{"zh-cn":"周日_周一_周二_周三_周四_周五_周六".split("_"),en:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_")}}},render:function(t){return t("div",{class:[this.prefixCls,"is-"+this.mode]},[this.genHeader(t),this.genWeekTitle(t),this.genCalendateItem(t)])}};module.exports=calendar$1;